import { existsSync } from 'node:fs';
import { join } from 'node:path';
import { createJiti } from 'jiti';
/**
 * Loads the LinkApp configuration from the user's project
 * @param projectPath - Path to the user's project (defaults to cwd)
 * @returns The loaded configuration
 * @throws Error if config file is not found or cannot be loaded
 */
export function loadConfig(projectPath = process.cwd()) {
    // Check for config in root first, then .config directory
    const rootConfigPath = join(projectPath, 'linkapp.config.ts');
    const nestedConfigPath = join(projectPath, '.config', 'linkapp.config.ts');
    const configPath = existsSync(rootConfigPath) ? rootConfigPath : nestedConfigPath;
    if (!existsSync(configPath)) {
        throw new Error('Config file not found: linkapp.config.ts');
    }
    try {
        // Load the TypeScript config using jiti
        const jiti = createJiti(import.meta.url, {
            interopDefault: true,
            moduleCache: false,
        });
        const config = jiti(configPath);
        return config;
    }
    catch (error) {
        throw new Error(`Failed to load config: ${error instanceof Error ? error.message : error}`);
    }
}
//# sourceMappingURL=load-config.js.map