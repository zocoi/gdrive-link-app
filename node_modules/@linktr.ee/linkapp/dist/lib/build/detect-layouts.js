import { existsSync } from 'node:fs';
import { join } from 'node:path';
/**
 * Detects layout files in the project's /app directory
 * Only sheet.tsx, featured.tsx, and featured-carousel.tsx are supported as layout entry points
 */
export function detectLayouts(projectPath) {
    const appDir = join(projectPath, 'app');
    if (!existsSync(appDir)) {
        return { layouts: [], hasLayout: false };
    }
    const layouts = [];
    // Supported layouts: Only sheet.tsx, featured.tsx, and featured-carousel.tsx are valid layout entry points
    const supportedLayouts = [
        { name: 'sheet', fileName: 'sheet.tsx', displayName: 'Sheet' },
        { name: 'featured', fileName: 'featured.tsx', displayName: 'Featured' },
        { name: 'featured-carousel', fileName: 'featured-carousel.tsx', displayName: 'FeaturedCarousel' },
    ];
    for (const layout of supportedLayouts) {
        const layoutPath = join(appDir, layout.fileName);
        if (existsSync(layoutPath)) {
            layouts.push(layout);
        }
    }
    const hasLayout = existsSync(join(appDir, 'layout.tsx')) || existsSync(join(appDir, 'layout.ts'));
    return {
        layouts,
        hasLayout,
    };
}
/**
 * Validates that required layout files exist
 */
export function validateLayouts(projectPath) {
    const detection = detectLayouts(projectPath);
    const errors = [];
    // sheet.tsx is always required
    const hasSheet = detection.layouts.some(l => l.name === 'sheet');
    if (!hasSheet) {
        errors.push('app/sheet.tsx is required. This is the default layout for your Link App.');
    }
    // Layout wrapper is optional - will be used if present
    return {
        valid: errors.length === 0,
        errors,
    };
}
//# sourceMappingURL=detect-layouts.js.map