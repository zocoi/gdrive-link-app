import pc from 'picocolors';
import open from 'open';
import { getAppConfig } from '../lib/auth/config.js';
import { removeToken } from '../lib/auth/token-storage.js';
const writeLine = (message = '') => {
    process.stdout.write(`${message}\n`);
};
export async function logoutCommand(options) {
    const env = options.qa ? 'QA' : 'Production';
    writeLine(pc.cyan(`ðŸ”“ Logging out from ${env}...`));
    writeLine();
    try {
        const config = await getAppConfig(options.qa ? 'qa' : 'production');
        // Remove stored token for the specified audience
        removeToken(config.auth.audience);
        // Build logout URL
        const logoutUrl = `${config.auth.domain}/v2/logout?client_id=${config.auth.client_id}&returnTo=${config.logout_redirect_url}`;
        // Open browser to clear session
        await open(logoutUrl);
        writeLine(pc.green('âœ“ Logged out successfully'));
        writeLine(pc.dim('  Browser opened to clear session'));
        writeLine(pc.dim(`  If browser did not open, visit: ${logoutUrl}`));
        writeLine();
    }
    catch (error) {
        console.error(pc.red('âœ— Logout failed:'), error);
        process.exit(1);
    }
}
//# sourceMappingURL=logout.js.map