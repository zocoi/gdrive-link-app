import { z } from "zod";
/**
 * Zod schema for LinkApp configuration
 * Uses snake_case naming to match API requirements
 */
const urlSchema = z.string().url();
const emailSchema = z.string().email();
const versionSchema = z
    .string()
    .regex(/^\d+\.\d+\.\d+$/, "Must be semver format (e.g., 1.0.0)");
// Supporting Links Schema
const supporting_links_schema = z.object({
    terms_of_service: urlSchema.describe("The URL of the terms of service"),
    privacy_policy: urlSchema.describe("The URL of the privacy policy"),
    documentation: urlSchema.optional().describe("The URL of the documentation"),
    website: urlSchema.optional().describe("The URL of the website"),
});
// Author Schema
const authorSchema = z.object({
    name: z.string().min(1, "Author name is required"),
    accounts: z.array(z.string()).min(1, "At least one account is required"),
    contact: z.object({
        url: urlSchema,
        email: emailSchema,
    }),
});
// Link Type Category V2 Schema
const linkTypeCategoryV2Schema = z.enum([
    "tours-and-shows",
    "social-media",
    "text",
    "audio",
    "document",
    "video",
    "promotions",
    "communities",
    "digital-products",
    "physical-products",
    "fundraising",
    "details",
    "forms",
    "scheduling",
]);
// Manifest Schema
const manifestSchema = z.object({
    name: z
        .string()
        .min(3, "Name must be at least 3 characters")
        .max(50, "Name must be at most 50 characters")
        .describe("The name of the link type (will be kebab-cased to generate the LinkApp ID)"),
    tagline: z
        .string()
        .min(3, "Tagline must be at least 3 characters")
        .max(200, "Tagline must be at most 200 characters")
        .describe("A short tagline for the link type"),
    description: z
        .array(z.string())
        .min(1, "At least one description paragraph is required")
        .describe("Array of description paragraphs"),
    manifest_version: versionSchema.describe("The manifest schema version"),
    version: versionSchema.describe("The version of the linkapp"),
    supporting_links: supporting_links_schema,
    category: z
        .enum(["grow", "sell", "share", "learn"])
        .describe("The category of the link type"),
    categoryV2: linkTypeCategoryV2Schema
        .optional()
        .describe("The version 2 category of the link type"),
    categoryV2Order: z
        .number()
        .optional()
        .describe("The sort order for categoryV2"),
    search_terms: z
        .array(z.string())
        .min(1, "At least one search term is required"),
    author: authorSchema,
});
// Enums matching the backend types
const settingsIconSchema = z.enum([
    "file",
    "settings",
    "text_and_media",
    "question",
]);
const featuredChinPositionSchema = z.enum([
    "none",
    "above",
    "below",
    "overlayBelow",
    "overlayAbove",
]);
const sheetBehaviorSchema = z.enum([
    "none",
    "expandGeneric",
    "expandVideo",
    "default",
]);
const featuredHeadClickBehaviorSchema = z.enum([
    "linkOff",
    "expand",
    "custom",
    "inlineVideoPlayer",
    "default",
]);
const settingsElementInputSchema = z.enum([
    "button",
    "text",
    "textarea",
    "number",
    "radio",
    "checkbox",
    "select",
    "password",
    "switch",
    "linkBehavior",
    "file",
    "url",
    "integration",
    "embedOption",
    "array",
]);
const integrationCapabilitySchema = z.enum(["MANAGE_EMAIL_SUBSCRIBERS"]);
const interactionEventSchema = z.enum(["click"]);
const actionTypeSchema = z.enum(["update-link"]);
// Supporting schemas
const settingsElementActionSchema = z.object({
    on: interactionEventSchema,
    type: actionTypeSchema,
    data: z.object({
        link_type: z.string(),
    }),
});
const settingsElementValidationSchema = z.object({
    required: z.boolean().optional(),
    pattern: z.string().optional(),
    minLength: z.number().optional(),
    maxLength: z.number().optional(),
    min: z.number().optional(),
    max: z.number().optional(),
    maxSize: z.number().optional(),
});
const settingsOverviewSchema = z.object({
    title: z.string().optional(),
    description: z.string().min(1, "Overview description is required"),
});
const setupInstructionsSchema = z.object({
    title: z.string().optional(),
    description: z.string().min(1, "Setup instructions description is required"),
});
const settingsElementOptionSchema = z.object({
    value: z.string(),
    label: z.string(),
});
const settingsElementLinkBehaviorLabelSchema = z.object({
    linkOffLabel: z.string(),
    embedLabel: z.string(),
});
const conditionalDisplaySchema = z.object({
    dependsOn: z.string(),
    value: z.union([z.string(), z.boolean()]),
    operator: z.enum(["equals", "notEquals", "contains"]).optional(),
});
const arrayOptionsSchema = z.object({
    add_item_button_text: z.string().optional(),
    add_item_title: z.string().optional(),
    add_second_item_button_text: z.string().optional(),
    edit_item_title: z.string().optional(),
    item_format: z.string().optional(),
    min: z.number().optional(),
    max: z.number().optional(),
});
// Settings Element Schema
const settingsElementSchema = z
    .object({
    id: z.string().min(1, "Element ID is required"),
    inputType: settingsElementInputSchema,
    title: z.string().optional(),
    description: z.string().optional(),
    defaultValue: z
        .union([z.string(), z.array(z.string()), z.boolean()])
        .optional(),
    label: z.string().optional(),
    placeholder: z.string().optional(),
    validation: settingsElementValidationSchema.optional(),
    options: z.array(settingsElementOptionSchema).optional(),
    linkBehaviorLabels: settingsElementLinkBehaviorLabelSchema.optional(),
    accept: z.array(z.string()).optional(),
    multiple: z.boolean().optional(),
    action: settingsElementActionSchema.optional(),
    capability: integrationCapabilitySchema.optional(),
    vendor: z.string().optional(),
    array_options: arrayOptionsSchema.optional(),
    array_elements: z.lazy(() => z.array(settingsElementSchema)).optional(),
    conditionalDisplay: conditionalDisplaySchema.optional(),
})
    .strict();
// Settings Schema
const settingsSchema = z.object({
    title: z.string().min(1, "Settings title is required"),
    icon: settingsIconSchema.optional(),
    uses_url: z.boolean().optional(),
    has_url: z.boolean().optional(),
    settings_tab_title: z.string().optional(),
    overview: settingsOverviewSchema.optional(),
    setup_instructions: setupInstructionsSchema.optional(),
    elements: z.array(settingsElementSchema).min(0),
    has_settings: z.boolean().optional(),
    // supports_featured_layout is auto-detected based on app/featured.tsx presence
    supports_featured_layout: z.boolean().optional(),
    featured_chin_position: featuredChinPositionSchema.optional(),
    featured_head_allow_unlocked_aspect_ratio: z.boolean().optional(),
    sheet_behavior: sheetBehaviorSchema.optional(),
    featured_head_click_behavior: featuredHeadClickBehaviorSchema.optional(),
});
// URL Match Rules Schema
const urlMatchRulesSchema = z.object({
    hostnames: z.array(z.string()).min(1, "At least one hostname is required"),
    patterns: z
        .array(z.object({
        pathname: z.string().min(1, "Pathname pattern is required"),
    }))
        .optional(),
    notPatterns: z
        .array(z.object({
        pathname: z.string().min(1, "Pathname pattern is required"),
    }))
        .optional(),
});
// Theme Schema
const themeSchema = z.object({
    isOutlineStyle: z.boolean().optional(),
    cssVariables: z.record(z.string(), z.string()),
    // Legacy properties (deprecated - maintained for backward compatibility)
    textColor: z.string(),
    backgroundColor: z.string(),
    borderRadius: z.string(),
    borderColor: z.string(),
    backgroundHover: z.string(),
    contrastColor: z.string(),
    textHoverColor: z.string(),
});
const viewportSchema = z.object({
    width: z.number(),
    height: z.number(),
});
const positionSchema = z.object({
    latitude: z.number(),
    longitude: z.number(),
});
// Preview Props Schema - for development mode
const preview_props_schema = z
    .object({
    // Extension data
    __linkUrl: z.string().optional(),
    __thumbnail: z.string().optional(),
    __linkParams: z.record(z.string(), z.unknown()).nullable().optional(),
    __layout: z.enum(["classic", "featured"]).optional(),
    groupLayoutOption: z
        .enum([
        "stack",
        "grid",
        "featured",
        "carousel",
        "featuredSubscribe",
        "showcase",
    ])
        .optional(),
    displayType: z.enum(["none", "accordion", "dialog"]).optional(),
    linkTitle: z.string().optional(),
    // Extension environment
    __environment: z
        .object({
        GRAPH_ENDPOINT: z.string().optional(),
        RECAPTCHA_SITE_KEY: z.string().optional(),
        GRAPHQL_CLIENT_NAME: z.string().optional(),
        GRAPHQL_CLIENT_VERSION: z.string().optional(),
        COUNTRY_CODE: z.string().optional(),
        PROFILE: z.string().optional(),
    })
        .optional(),
    // Layout and theme
    layout: z.enum(["stack", "grid", "carousel", "featured"]).optional(),
    theme: themeSchema.optional(),
})
    .catchall(z.unknown());
// Main LinkApp Config Schema (internal use only)
const linkAppConfigSchema = z.object({
    manifest: manifestSchema,
    settings: settingsSchema,
    url_match_rules: urlMatchRulesSchema.optional(),
    preview_props: preview_props_schema.optional(),
});
//# sourceMappingURL=config.schema.js.map